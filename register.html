<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å | ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</title>
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;}
body{
  margin:0;font-family:'Kanit',sans-serif;
  background:linear-gradient(135deg,#715aff,#2b2d42);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  min-height:100vh;color:#fff;transition:0.4s;
}
body.light{background:linear-gradient(135deg,#f4f4f7,#cfd1e1);color:#111;}
header{position:absolute;top:20px;left:20px;right:20px;display:flex;justify-content:space-between;align-items:center;}
h1{margin:0;font-weight:600;}
.mode-toggle{
  background:#715aff;color:#fff;border:none;border-radius:50%;width:40px;height:40px;
  cursor:pointer;font-size:20px;transition:0.3s;
}
.mode-toggle:hover{transform:scale(1.1);}
.register-card{
  background:rgba(255,255,255,0.1);backdrop-filter:blur(8px);
  padding:30px;border-radius:16px;width:90%;max-width:420px;text-align:center;
  box-shadow:0 0 15px rgba(0,0,0,0.2);transition:0.3s;animation:fadeIn 0.8s ease;
}
body.light .register-card{background:#fff;color:#111;}
.register-card input{
  width:100%;padding:10px 12px;margin:8px 0;border-radius:8px;border:1px solid #ccc;
  font-family:inherit;font-size:15px;outline:none;transition:0.3s;
}
.register-card input:focus{border-color:#715aff;box-shadow:0 0 6px #715aff;}
.register-card button{
  width:100%;padding:10px;background:#715aff;color:#fff;border:none;border-radius:12px;
  cursor:pointer;font-size:16px;margin-top:10px;transition:0.3s;
}
.register-card button:hover{background:#5d4de0;box-shadow:0 0 10px rgba(113,90,255,0.6);}
.login-link{font-size:14px;color:#fff;margin-top:10px;cursor:pointer;display:inline-block;}
body.light .login-link{color:#333;}
#toast{
  position:fixed;bottom:24px;right:24px;padding:10px 16px;border-radius:8px;
  opacity:0;transform:translateY(20px);transition:0.3s;z-index:2000;color:#fff;
}
#toast.show{opacity:1;transform:translateY(0);}
#toast.success{background:#27ae60;}
#toast.error{background:#e74c3c;}
#toast.warning{background:#f1c40f;color:#111;}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
</style>
</head>
<body>
  <header>
    <h1>‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏´‡∏°‡πà</h1>
    <button id="modeToggle" class="mode-toggle">üåô</button>
  </header>

  <div class="register-card" id="registerCard">
    <input type="text" id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‚Äì‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
    <input type="email" id="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
    <input type="password" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
    <input type="password" id="confirm" placeholder="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
    <button id="registerBtn">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
    <span class="login-link" id="backToLogin">‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß? ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</span>
  </div>

  <div id="toast"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, sendEmailVerification } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyB_7tyj_BAyFzKEYVrZXfQjWCUXGS7VqKY",
  authDomain: "my-todo-list-9d2fa.firebaseapp.com",
  projectId: "my-todo-list-9d2fa",
  storageBucket: "my-todo-list-9d2fa.appspot.com",
  messagingSenderId: "631403892452",
  appId: "1:631403892452:web:66d382bf5f143fc05de6f1"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const nameEl=document.getElementById("name");
const emailEl=document.getElementById("email");
const passEl=document.getElementById("password");
const confirmEl=document.getElementById("confirm");
const registerBtn=document.getElementById("registerBtn");
const toast=document.getElementById("toast");
const modeToggle=document.getElementById("modeToggle");
const backToLogin=document.getElementById("backToLogin");

if(localStorage.getItem("theme")==="light"){document.body.classList.add("light");modeToggle.textContent="üåô";}
modeToggle.onclick=()=>{
  document.body.classList.toggle("light");
  const light=document.body.classList.contains("light");
  localStorage.setItem("theme",light?"light":"dark");
  modeToggle.textContent=light?"üåô":"‚òÄÔ∏è";
};

function showToast(msg,type){
  toast.textContent=msg;
  toast.className=`show ${type||""}`;
  setTimeout(()=>toast.className="",4000);
}

backToLogin.onclick=()=>window.location.href="login.html";

registerBtn.onclick=async()=>{
  const name=nameEl.value.trim();
  const email=emailEl.value.trim();
  const pass=passEl.value.trim();
  const confirm=confirmEl.value.trim();

  if(!name||!email||!pass||!confirm){
    showToast("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô","error");
    return;
  }
  if(pass!==confirm){
    showToast("‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô","error");
    return;
  }

  registerBtn.disabled=true;
  registerBtn.textContent="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å...";

  try{
    const userCred=await createUserWithEmailAndPassword(auth,email,pass);
    const user=userCred.user;
    await setDoc(doc(db,"users",user.uid),{
      uid:user.uid,
      email:user.email,
      name:name,
      role:"user",
      verified:false,
      createdAt:serverTimestamp()
    });
    await sendEmailVerification(user);
    showToast("üì© ‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢","warning");
    const back=document.createElement("button");
    back.textContent="‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
    back.style.marginTop="15px";
    back.style.background="#27ae60";
    back.onclick=()=>window.location.href="login.html";
    document.getElementById("registerCard").appendChild(back);
  }catch(e){
    console.error(e);
    if(e.code==="auth/email-already-in-use") showToast("‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß","error");
    else showToast("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î","error");
    registerBtn.disabled=false;
    registerBtn.textContent="‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å";
  }
};
</script>
</body>
</html>
