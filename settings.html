<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ | TodoTask Pro Enterprise</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #6a4cff;
      --secondary: #8e7dff;
      --bg-dark: #0a0717;
      --bg-light: #f8f8ff;
      --glass-dark: rgba(20,20,40,0.4);
      --glass-light: rgba(255,255,255,0.25);
      --text-dark: #1e1e1e;
      --text-light: #f4f4f4;
    }

    body {
      font-family: 'Sarabun', sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #1a1133, #0a0717);
      color: var(--text-light);
      transition: 0.5s;
    }

    body.light {
      background: linear-gradient(135deg, #f3f1ff, #ffffff);
      color: var(--text-dark);
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--glass-dark);
      backdrop-filter: blur(10px);
      padding: 15px 25px;
      position: sticky;
      top: 0;
      z-index: 10;
      color: var(--text-light);
      box-shadow: 0 3px 15px rgba(0,0,0,0.3);
    }
    body.light header {
      background: var(--glass-light);
      color: var(--text-dark);
    }

    .back-btn {
      background: transparent;
      border: none;
      font-size: 1.5em;
      color: inherit;
      cursor: pointer;
      transition: 0.3s;
    }
    .back-btn:hover { transform: scale(1.2); }

    main {
      max-width: 800px;
      margin: 40px auto;
      padding: 25px;
      background: var(--glass-dark);
      border-radius: 15px;
      backdrop-filter: blur(12px);
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    }
    body.light main {
      background: var(--glass-light);
      box-shadow: 0 3px 15px rgba(0,0,0,0.1);
    }

    h2 {
      text-align: center;
      color: var(--secondary);
    }

    .setting-group {
      margin-bottom: 25px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      padding-bottom: 15px;
    }
    body.light .setting-group {
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
    }

    input, select {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: none;
      background: rgba(255,255,255,0.1);
      color: inherit;
      margin-bottom: 10px;
      backdrop-filter: blur(6px);
    }
    body.light input, body.light select {
      background: rgba(255,255,255,0.7);
      color: var(--text-dark);
    }

    button {
      background: var(--secondary);
      color: white;
      border: none;
      border-radius: 10px;
      padding: 12px 18px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: var(--primary);
      transform: translateY(-2px);
    }

    footer {
      text-align: center;
      color: #aaa;
      margin-top: 40px;
      padding-bottom: 20px;
      font-size: 14px;
    }
  </style>
</head>

<body>
  <header>
    <button class="back-btn" onclick="goBack()">‚¨ÖÔ∏è</button>
    <h3>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h3>
    <button onclick="toggleTheme()" style="background:none;border:none;font-size:1.2em;color:inherit;cursor:pointer;">üåô</button>
  </header>

  <main>
    <h2>‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h2>

    <div class="setting-group">
      <h3>üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h3>
      <label>‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏á‡∏≤‡∏ô)</label>
      <input type="number" id="goal" placeholder="‡πÄ‡∏ä‡πà‡∏ô 100">
    </div>

    <div class="setting-group">
      <h3>üë• ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô</h3>
      <label>‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</label>
      <select id="teamSelect">
        <option value="teamA">‡∏ó‡∏µ‡∏° A</option>
        <option value="teamB">‡∏ó‡∏µ‡∏° B</option>
        <option value="teamC">‡∏ó‡∏µ‡∏° C</option>
      </select>
      <label>‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡∏°</label>
      <input type="number" id="teamGoal" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡∏°">
    </div>

    <div class="setting-group">
      <h3>üßë‚Äçüíº ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
      <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
      <input type="email" id="userEmail" placeholder="‡πÄ‡∏ä‡πà‡∏ô user@example.com">
      <label>‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</label>
      <select id="userRole">
        <option value="staff">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option>
        <option value="admin">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</option>
        <option value="viewer">‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°</option>
      </select>
    </div>

    <div class="setting-group">
      <h3>üîî ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
      <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</label>
      <select id="notify">
        <option value="on">‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
        <option value="off">‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</option>
      </select>
    </div>

    <button onclick="saveSettings()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
  </main>

  <footer>¬© 2025 TodoTask Pro Enterprise</footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyB_7tyj_BAyFzKEYVrZXfQjWCUXGS7VqKY",
      authDomain: "my-todo-list-9d2fa.firebaseapp.com",
      projectId: "my-todo-list-9d2fa",
      storageBucket: "my-todo-list-9d2fa.appspot.com",
      messagingSenderId: "631403892452",
      appId: "1:631403892452:web:66d382bf5f143fc05de6f1"
    };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    onAuthStateChanged(auth, user => {
      if (!user) location.href = "index.html";
      else loadSettings();
    });

    window.goBack = () => location.href = "index.html";
    window.toggleTheme = () => {
      document.body.classList.toggle("light");
      localStorage.setItem("theme", document.body.classList.contains("light") ? "light" : "dark");
    };
    if (localStorage.getItem("theme") === "light") document.body.classList.add("light");

    async function loadSettings() {
      const ref = doc(db, "settings", "organization");
      const snap = await getDoc(ref);
      if (snap.exists()) {
        const data = snap.data();
        document.getElementById("goal").value = data.goal || "";
        document.getElementById("teamSelect").value = data.selectedTeam || "teamA";
        document.getElementById("teamGoal").value = data.teamGoal || "";
        document.getElementById("notify").value = data.notify || "on";
      }
    }

    window.saveSettings = async () => {
      const ref = doc(db, "settings", "organization");
      const data = {
        goal: parseInt(document.getElementById("goal").value) || 0,
        teamGoal: parseInt(document.getElementById("teamGoal").value) || 0,
        selectedTeam: document.getElementById("teamSelect").value,
        notify: document.getElementById("notify").value,
        updated: new Date().toISOString()
      };
      await setDoc(ref, data);
      alert("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
    };
  </script>
</body>
</html>
