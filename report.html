<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏ß‡∏°‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ | TodoTask Pro Enterprise</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root {
  --primary:#6a4cff;
  --secondary:#8e7dff;
  --bg-dark:#0a0717;
  --bg-light:#f9f8ff;
  --card-dark:#1a1630;
  --card-light:#ffffff;
  --text-dark:#222;
  --text-light:#f2f2f2;
}

/* üåå Base Theme */
body {
  font-family:'Sarabun',sans-serif;
  margin:0;
  background:linear-gradient(135deg,#1a1133,#0a0717);
  color:var(--text-light);
  transition:.4s;
  min-height:100vh;
}
body.light {
  background:linear-gradient(135deg,#f3f1ff,#fff);
  color:var(--text-dark);
}

/* Header */
.header {
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  padding:20px 0;
  background:rgba(255,255,255,0.05);
  backdrop-filter:blur(10px);
  box-shadow:0 2px 10px rgba(0,0,0,.3);
}
body.light .header {
  background:rgba(255,255,255,0.7);
  box-shadow:0 2px 10px rgba(0,0,0,.1);
}
.header h2 {
  margin:0;
  font-weight:600;
}
.back-btn {
  position:absolute;
  left:20px;
  top:50%;
  transform:translateY(-50%);
  background:rgba(255,255,255,0.15);
  border:none;
  border-radius:50%;
  color:white;
  font-size:20px;
  width:45px;
  height:45px;
  cursor:pointer;
  backdrop-filter:blur(10px);
  transition:all .3s;
}
.back-btn:hover {transform:translateY(-50%) scale(1.1);}
body.light .back-btn {color:#2b1f5f;background:rgba(255,255,255,0.6);}

/* Container */
.container {
  max-width:1000px;
  margin:40px auto;
  background:rgba(255,255,255,0.08);
  border-radius:15px;
  padding:30px;
  backdrop-filter:blur(12px);
  box-shadow:0 0 20px rgba(120,80,255,0.3);
}
body.light .container {
  background:rgba(255,255,255,0.8);
  box-shadow:0 0 15px rgba(0,0,0,0.1);
}

/* Toolbar */
.toolbar {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
  flex-wrap:wrap;
  gap:10px;
}
select,button {
  padding:10px 14px;
  border:none;
  border-radius:8px;
  font-size:15px;
  cursor:pointer;
  transition:.3s;
}
select {
  background:rgba(255,255,255,0.1);
  color:white;
  backdrop-filter:blur(8px);
}
body.light select {
  background:rgba(255,255,255,0.9);
  color:#333;
}
button.download {
  background:linear-gradient(135deg,#6a4cff,#9b7fff);
  color:white;
  font-weight:600;
}
button.download:hover {
  transform:scale(1.05);
}

/* Chart Boxes */
.chart-box {
  background:rgba(255,255,255,0.08);
  border-radius:10px;
  padding:20px;
  margin-bottom:30px;
  backdrop-filter:blur(8px);
  text-align:center;
}
body.light .chart-box {background:rgba(255,255,255,0.8);}
canvas {width:100%;max-height:320px;}

/* Table */
table {
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td {
  padding:12px;
  text-align:left;
  border-bottom:1px solid rgba(255,255,255,0.2);
}
th {
  background:linear-gradient(135deg,#6a4cff,#9b7fff);
  color:white;
  border-radius:8px 8px 0 0;
}
body.light th,body.light td {
  border-color:rgba(0,0,0,0.1);
}

/* Footer */
footer {
  text-align:center;
  margin-top:40px;
  color:#888;
  font-size:14px;
}
</style>
</head>

<body>
  <div class="header">
    <button class="back-btn" onclick="goBack()">‚¨Ö</button>
    <h2>üìà ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏ß‡∏°‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h2>
  </div>

  <div class="container" id="reportArea">
    <div class="toolbar">
      <div>
        <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: </label>
        <select id="monthSelect" onchange="loadReport()">
          <option value="2025-01">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
          <option value="2025-02">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
          <option value="2025-03">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
          <option value="2025-04">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
          <option value="2025-05">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
          <option value="2025-06">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
          <option value="2025-07">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
          <option value="2025-08">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
          <option value="2025-09">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
          <option value="2025-10">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
          <option value="2025-11">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
          <option value="2025-12">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
        </select>
      </div>
      <button class="download" onclick="downloadPDF()">üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô PDF</button>
    </div>

    <div class="chart-box">
      <h3>üìä ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡∏°</h3>
      <canvas id="teamChart"></canvas>
    </div>

    <div class="chart-box">
      <h3>üìà ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h3>
      <canvas id="trendChart"></canvas>
    </div>

    <div class="chart-box">
      <h3>üìã ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h3>
      <table id="reportTable">
        <thead>
          <tr>
            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</th>
            <th>‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
            <th>‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à</th>
            <th>‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <footer>¬© 2025 TodoTask Pro Enterprise ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";
import { jsPDF } from "https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js";

const firebaseConfig={
  apiKey:"AIzaSyB_7tyj_BAyFzKEYVrZXfQjWCUXGS7VqKY",
  authDomain:"my-todo-list-9d2fa.firebaseapp.com",
  projectId:"my-todo-list-9d2fa",
  storageBucket:"my-todo-list-9d2fa.appspot.com",
  messagingSenderId:"631403892452",
  appId:"1:631403892452:web:66d382bf5f143fc05de6f1"
};
const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

// üåó Theme
if(localStorage.getItem("theme")==="light")document.body.classList.add("light");

// ‚¨ÖÔ∏è Back
window.goBack=()=>window.history.back();

// üìä ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏à‡∏≥‡∏•‡∏≠‡∏á)
let teamChart,trendChart;
window.loadReport=()=>{
  const teams=[
    {name:"‡∏ó‡∏µ‡∏° A",done:45,total:50},
    {name:"‡∏ó‡∏µ‡∏° B",done:30,total:42},
    {name:"‡∏ó‡∏µ‡∏° C",done:38,total:55}
  ];
  renderTable(teams);
  renderCharts(teams);
};

function renderTable(teams){
  const tbody=document.querySelector("#reportTable tbody");
  tbody.innerHTML="";
  teams.forEach(t=>{
    const percent=Math.round((t.done/t.total)*100);
    tbody.innerHTML+=`<tr><td>${t.name}</td><td>${t.total}</td><td>${t.done}</td><td>${percent}%</td></tr>`;
  });
}

function renderCharts(teams){
  const labels=teams.map(t=>t.name);
  const done=teams.map(t=>t.done);
  const total=teams.map(t=>t.total);

  if(teamChart)teamChart.destroy();
  if(trendChart)trendChart.destroy();

  teamChart=new Chart(document.getElementById("teamChart"),{
    type:"doughnut",
    data:{labels,datasets:[{data:done,backgroundColor:["#8e7dff","#b19cff","#d2b8ff"]}]},
    options:{cutout:"70%",plugins:{legend:{position:"bottom"}}}
  });

  trendChart=new Chart(document.getElementById("trendChart"),{
    type:"bar",
    data:{
      labels:["‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå 1","‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå 2","‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå 3","‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå 4"],
      datasets:[{label:"‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à",data:[12,15,10,18],backgroundColor:"#8e7dff"}]
    },
    options:{scales:{y:{beginAtZero:true}}}
  });
}

// üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF
window.downloadPDF=()=>{
  const doc=new jsPDF();
  doc.text("‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏ß‡∏°‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ - TodoTask Pro Enterprise",10,10);
  doc.text("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á: "+new Date().toLocaleDateString("th-TH"),10,20);
  doc.html(document.getElementById("reportArea"),{
    callback:function(doc){doc.save("‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£.pdf");},
    x:10,y:30,width:180
  });
};

loadReport();
</script>
</body>
</html>
