<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Test Dashboard | TodoTask Pro</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg-light: #f7f7f8;
      --bg-dark: #0c0f1c;
      --card-light: #fff;
      --card-dark: #1c2030;
      --accent: #4A90E2;
      --accent-alt: #e0c097;
      --text-light: #eee;
      --text-dark: #222;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-light);
      color: var(--text-dark);
      margin: 0;
      transition: background 0.4s, color 0.4s;
    }

    body.dark {
      background: radial-gradient(circle at center, #0c1023, #000);
      color: var(--text-light);
    }

    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--card-light);
      padding: 15px 30px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    body.dark .navbar { background: var(--card-dark); }

    .container {
      max-width: 900px;
      margin: 30px auto;
      padding: 20px;
    }

    .toolbar {
      text-align: center;
      margin-bottom: 25px;
    }

    .toolbar button, select {
      margin: 5px;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background: var(--accent);
      color: white;
      font-weight: 500;
      transition: 0.3s;
    }

    .toolbar button:hover { transform: translateY(-2px); }

    .task-board {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }

    .task {
      flex: 1 1 260px;
      background: var(--card-light);
      border-left: 5px solid var(--accent);
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      transition: transform 0.2s;
    }

    .task:hover { transform: scale(1.02); }
    body.dark .task { background: var(--card-dark); border-color: var(--accent-alt); }
    .task.completed { opacity: 0.6; text-decoration: line-through; }

    .chart-box {
      margin-top: 30px;
      background: var(--card-light);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    body.dark .chart-box { background: var(--card-dark); }

    canvas { width: 100%; max-height: 300px; }

    @media (max-width: 600px) {
      .task-board { flex-direction: column; }
    }
  </style>
</head>

<body>
  <div class="navbar">
    <h2>üß™ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö TodoTask Pro</h2>
    <div>
      <button onclick="toggleTheme()">üåó</button>
      <button onclick="resetDemo()">‚ôªÔ∏è ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
      <button onclick="goReal()">üöÄ ‡πÑ‡∏õ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á</button>
    </div>
  </div>

  <div class="container">
    <div class="toolbar">
      <label>‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó: </label>
      <select id="roleSelect" onchange="changeRole()">
        <option value="admin">üëë Admin</option>
        <option value="leader">üë®‚Äçüíº ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡∏°</option>
        <option value="staff">üë∑‚Äç‚ôÇÔ∏è ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option>
        <option value="viewer">üë§ ‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°</option>
      </select>
      <button onclick="addTask()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</button>
      <button onclick="toggleRandomTask()">‚úÖ ‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏¥‡πä‡∏Å‡∏á‡∏≤‡∏ô</button>
    </div>

    <div class="task-board" id="taskBoard"></div>

    <div class="chart-box">
      <h3>üìä ‡∏Å‡∏£‡∏≤‡∏ü‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</h3>
      <canvas id="progressChart"></canvas>
    </div>

    <div class="chart-box">
      <h3>üìà ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</h3>
      <canvas id="trendChart"></canvas>
    </div>
  </div>

  <script>
    let role = "admin";
    let demoTasks = [
      { id: 1, text: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö API", completed: false, owner: "‡∏ó‡∏µ‡∏° A" },
      { id: 2, text: "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î", completed: true, owner: "‡∏ó‡∏µ‡∏° B" },
      { id: 3, text: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô", completed: false, owner: "‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß" },
    ];

    function renderTasks() {
      const board = document.getElementById("taskBoard");
      board.innerHTML = "";
      demoTasks.forEach(task => {
        const div = document.createElement("div");
        div.className = "task" + (task.completed ? " completed" : "");
        div.innerHTML = `
          <p><b>${task.text}</b> <small>(${task.owner})</small></p>
          ${role !== "viewer"
            ? `<button onclick="toggleTask(${task.id})">${task.completed ? "‚Ü©Ô∏è ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö" : "‚úîÔ∏è ‡πÄ‡∏™‡∏£‡πá‡∏à"}</button>`
            : ""}
          ${role === "admin" ? `<button onclick="deleteTask(${task.id})">üóëÔ∏è</button>` : ""}
        `;
        board.appendChild(div);
      });
      updateCharts();
    }

    function changeRole() {
      role = document.getElementById("roleSelect").value;
      document.documentElement.style.setProperty('--accent', roleColor(role));
      renderTasks();
    }

    function roleColor(r) {
      switch (r) {
        case "admin": return "#e0c097";
        case "leader": return "#4A90E2";
        case "staff": return "#4AE290";
        default: return "#888";
      }
    }

    function addTask() {
      if (role === "viewer") return alert("‚ùå ‡πÇ‡∏´‡∏°‡∏î‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ");
      const id = Date.now();
      const text = prompt("‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà:");
      if (!text) return;
      demoTasks.push({ id, text, completed: false, owner: role });
      renderTasks();
    }

    function toggleTask(id) {
      const t = demoTasks.find(x => x.id === id);
      if (t) t.completed = !t.completed;
      renderTasks();
    }

    function deleteTask(id) {
      demoTasks = demoTasks.filter(t => t.id !== id);
      renderTasks();
    }

    function toggleRandomTask() {
      const i = Math.floor(Math.random() * demoTasks.length);
      demoTasks[i].completed = !demoTasks[i].completed;
      renderTasks();
    }

    function resetDemo() {
      demoTasks = [
        { id: 1, text: "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö API", completed: false, owner: "‡∏ó‡∏µ‡∏° A" },
        { id: 2, text: "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î", completed: true, owner: "‡∏ó‡∏µ‡∏° B" },
        { id: 3, text: "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô", completed: false, owner: "‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß" },
      ];
      renderTasks();
    }

    function goReal() {
      location.href = "dashboard-enterprise.html";
    }

    function updateCharts() {
      const done = demoTasks.filter(t => t.completed).length;
      const total = demoTasks.length;
      const percent = total ? Math.round((done / total) * 100) : 0;

      if (window.progressChart) window.progressChart.destroy();
      window.progressChart = new Chart(document.getElementById("progressChart"), {
        type: "doughnut",
        data: {
          labels: ["‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß", "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏£‡πá‡∏à"],
          datasets: [{ data: [done, total - done], backgroundColor: [roleColor(role), "#ccc"] }]
        },
        options: { cutout: "70%" }
      });

      if (window.trendChart) window.trendChart.destroy();
      window.trendChart = new Chart(document.getElementById("trendChart"), {
        type: "bar",
        data: {
          labels: ["‡∏à.", "‡∏≠.", "‡∏û.", "‡∏û‡∏§.", "‡∏®.", "‡∏™.", "‡∏≠‡∏≤."],
          datasets: [{ label: "‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à", data: Array(7).fill().map(() => Math.floor(Math.random() * 10)), backgroundColor: roleColor(role) }]
        },
        options: { scales: { y: { beginAtZero: true } } }
      });
    }

    function toggleTheme() {
      document.body.classList.toggle("dark");
      localStorage.setItem("theme", document.body.classList.contains("dark") ? "dark" : "light");
    }

    if (localStorage.getItem("theme") === "dark") document.body.classList.add("dark");

    renderTasks();
  </script>
</body>
</html>
