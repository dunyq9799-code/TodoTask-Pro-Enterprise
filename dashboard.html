<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TodoTask Pro Enterprise ‚Äì Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root {
  --cream-bg:#faf8f5;--light-gold:#e0c097;--text-dark:#444;
  --dark-bg:#0b0e23;--universe-accent:#6b63ff;--soft-border:#e4dacb;
}
body{
  margin:0;font-family:'Sarabun',sans-serif;
  transition:background .8s ease,color .5s ease;
  background:linear-gradient(to bottom right,#faf8f5,#f9f5ec);color:var(--text-dark);
}
body.universe{
  background:radial-gradient(circle at top,#0b0e23,#040714);
  color:#f1f1f1;
}
header{
  display:flex;justify-content:space-between;align-items:center;
  padding:20px 30px;font-weight:600;
}
header h1{font-size:22px;}
nav button{
  border:none;background:var(--light-gold);color:#fff;
  padding:10px 18px;border-radius:8px;cursor:pointer;
  transition:all .3s ease;
}
nav button:hover{opacity:.9;}
body.universe nav button{background:var(--universe-accent);}
.dashboard{
  display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:20px;padding:20px;max-width:1100px;margin:auto;
}
.card{
  background:rgba(255,255,255,0.85);backdrop-filter:blur(10px);
  border-radius:16px;padding:20px;box-shadow:0 4px 20px rgba(0,0,0,.05);
  transition:background .5s ease;
}
body.universe .card{
  background:rgba(25,25,40,0.75);border:1px solid rgba(255,255,255,.1);
}
.card h2{font-size:18px;margin-bottom:10px;}
.stats{display:flex;justify-content:space-around;text-align:center;}
.stats div{flex:1;}
canvas{width:100%!important;height:250px!important;}
.fab{
  position:fixed;bottom:30px;right:30px;width:60px;height:60px;
  border-radius:50%;font-size:30px;
  background:var(--light-gold);color:#fff;border:none;cursor:pointer;
  box-shadow:0 4px 15px rgba(0,0,0,.2);transition:transform .3s ease;
}
.fab:hover{transform:scale(1.1);}
body.universe .fab{background:var(--universe-accent);}
.theme-toggle{
  position:fixed;bottom:30px;left:30px;width:55px;height:55px;
  border-radius:50%;border:none;cursor:pointer;
  background:var(--light-gold);color:#fff;font-size:24px;
  box-shadow:0 4px 15px rgba(0,0,0,.2);
}
body.universe .theme-toggle{background:var(--universe-accent);}
@media(max-width:600px){header{flex-direction:column;gap:10px;}}
</style>
</head>
<body>
<header>
  <h1>üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ TodoTask Pro</h1>
  <nav>
    <button onclick="window.location.href='index.html'">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
  </nav>
</header>

<section class="dashboard">
  <div class="card">
    <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h2>
    <div class="stats">
      <div><h3 id="totalTasks">0</h3><p>‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p></div>
      <div><h3 id="completedTasks">0</h3><p>‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</p></div>
      <div><h3 id="pendingTasks">0</h3><p>‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà</p></div>
    </div>
  </div>

  <div class="card">
    <h2>‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</h2>
    <canvas id="pieChart"></canvas>
  </div>

  <div class="card">
    <h2>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏° 7 ‡∏ß‡∏±‡∏ô</h2>
    <canvas id="barChart"></canvas>
  </div>
</section>

<button class="fab" title="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà">Ôºã</button>
<button class="theme-toggle" id="themeToggle">üåç</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";

const firebaseConfig={
  apiKey:"AIzaSyB_7tyj_BAyFzKEYVrZXfQjWCUXGS7VqKY",
  authDomain:"my-todo-list-9d2fa.firebaseapp.com",
  projectId:"my-todo-list-9d2fa",
  storageBucket:"my-todo-list-9d2fa.appspot.com",
  messagingSenderId:"631403892452",
  appId:"1:631403892452:web:66d382bf5f143fc05de6f1"
};
const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

// ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü
async function loadDashboard(){
  const snapshot=await getDocs(collection(db,"tasks"));
  const tasks=snapshot.docs.map(d=>d.data());
  const total=tasks.length;
  const done=tasks.filter(t=>t.completed).length;
  const pending=total-done;
  document.getElementById("totalTasks").textContent=total;
  document.getElementById("completedTasks").textContent=done;
  document.getElementById("pendingTasks").textContent=pending;

  renderPie(done,pending);
  renderBar(tasks);
}

// Pie Chart
function renderPie(done,pending){
  new Chart(document.getElementById("pieChart"),{
    type:"doughnut",
    data:{labels:["‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß","‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà"],
      datasets:[{data:[done,pending],
        backgroundColor:["#e0c097","#ddd"],
        borderWidth:0}]},
    options:{plugins:{legend:{position:"bottom"}}}
  });
}

// Bar Chart
function renderBar(tasks){
  const days=["‡∏à.","‡∏≠.","‡∏û.","‡∏û‡∏§.","‡∏®.","‡∏™.","‡∏≠‡∏≤."];
  const donePerDay=new Array(7).fill(0);
  tasks.forEach(t=>{
    if(t.completed&&t.createdAt){
      const d=new Date(t.createdAt);
      donePerDay[d.getDay()]+=1;
    }
  });
  new Chart(document.getElementById("barChart"),{
    type:"bar",
    data:{labels:days,
      datasets:[{label:"‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à",
      data:donePerDay,
      backgroundColor:"#e0c097"}]},
    options:{scales:{y:{beginAtZero:true}}}
  });
}

// ‡∏ò‡∏µ‡∏°‡πÇ‡∏•‡∏Å ‚Üî ‡∏à‡∏±‡∏Å‡∏£‡∏ß‡∏≤‡∏•
const themeToggle=document.getElementById("themeToggle");
themeToggle.onclick=()=>{
  document.body.classList.toggle("universe");
  const isU=document.body.classList.contains("universe");
  themeToggle.textContent=isU?"üåå":"üåç";
  localStorage.setItem("theme",isU?"universe":"world");
};
window.onload=()=>{
  const saved=localStorage.getItem("theme");
  if(saved==="universe"){
    document.body.classList.add("universe");
    themeToggle.textContent="üåå";
  }
  loadDashboard();
};
</script>
</body>
</html>
