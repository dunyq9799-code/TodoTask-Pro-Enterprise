<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TodoTask Pro Enterprise</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet" />
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js"></script>
  <style>
    :root {
      --primary: #8e7dff;
      --primary-dark: #3a2b84;
      --accent: #bba7ff;
      --bg-light: #f6f5fb;
      --bg-dark: #0f0d19;
      --glass-bg: rgba(255,255,255,0.15);
      --glass-border: rgba(255,255,255,0.25);
      --text-light: #fafafa;
      --text-dark: #1e1e1e;
    }

    * { box-sizing: border-box; transition: 0.3s ease; }

    body {
      font-family: 'Sarabun', sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #2e0d60, #1a1133, #0e0c20);
      color: var(--text-light);
      overflow-x: hidden;
    }
    body.light {
      background: linear-gradient(135deg, #eae6ff, #f5f3ff);
      color: var(--text-dark);
    }

    header {
      position: fixed;
      top: 0; left: 0; right: 0;
      background: rgba(30, 20, 60, 0.5);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--glass-border);
      display: flex; justify-content: space-between; align-items: center;
      padding: 12px 25px;
      z-index: 50;
    }
    body.light header {
      background: rgba(255,255,255,0.5);
    }

    h1 { margin: 0; font-weight: 600; }

    .action-btn {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      color: inherit;
      padding: 10px 16px;
      border-radius: 10px;
      cursor: pointer;
      backdrop-filter: blur(10px);
      font-weight: 600;
    }

    .action-btn:hover { background: rgba(255,255,255,0.2); }

    .container {
      text-align: center;
      margin-top: 130px;
      padding: 20px;
    }

    .main-title {
      font-size: 2.2rem;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      color: transparent;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .sub {
      opacity: 0.85;
      font-size: 1.1rem;
      margin-bottom: 50px;
    }

    /* Floating Menu */
    .fab {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
      border-radius: 50%;
      width: 60px; height: 60px;
      font-size: 28px;
      color: var(--text-light);
      cursor: pointer;
      display: flex; justify-content: center; align-items: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      z-index: 100;
    }
    body.light .fab { color: var(--text-dark); }

    .fab-menu {
      position: fixed;
      bottom: 100px;
      right: 40px;
      display: none;
      flex-direction: column;
      gap: 10px;
      z-index: 99;
    }

    .fab-item {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      padding: 10px 14px;
      border-radius: 10px;
      backdrop-filter: blur(10px);
      cursor: pointer;
      color: var(--text-light);
      font-weight: 500;
      text-align: right;
      min-width: 140px;
    }
    body.light .fab-item { color: var(--text-dark); }

    .fab-item:hover {
      background: rgba(255,255,255,0.25);
    }

    /* Loader */
    .loader {
      position: fixed;
      top:0; left:0; width:100%; height:100%;
      background: rgba(20,10,40,0.8);
      display:flex; justify-content:center; align-items:center;
      backdrop-filter: blur(10px);
      z-index:999; display:none;
    }
    .loader div {
      width:60px; height:60px;
      border:6px solid #ccc;
      border-top:6px solid var(--primary);
      border-radius:50%;
      animation:spin 1s linear infinite;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
  </style>
</head>

<body>
  <div class="loader" id="loader"><div></div></div>
  <header>
    <h1>TodoTask Pro Enterprise</h1>
    <div>
      <button class="action-btn" id="authBtn">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      <button class="action-btn" id="themeBtn">üåô</button>
    </div>
  </header>

  <div class="container">
    <h2 class="main-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</h2>
    <p class="sub">‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</p>
  </div>

  <div class="fab" id="fab">‚ò∞</div>
  <div class="fab-menu" id="fabMenu">
    <div class="fab-item" onclick="goPage('report.html')">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>
    <div class="fab-item" onclick="goPage('settings.html')">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</div>
    <div class="fab-item" onclick="goPage('team.html')">üë• ‡∏ó‡∏µ‡∏°</div>
    <div class="fab-item admin-only" onclick="goPage('test.html')">üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö</div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signInWithPopup, GoogleAuthProvider, signOut } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyB_7tyj_BAyFzKEYVrZXfQjWCUXGS7VqKY",
      authDomain: "my-todo-list-9d2fa.firebaseapp.com",
      projectId: "my-todo-list-9d2fa",
      storageBucket: "my-todo-list-9d2fa.appspot.com",
      messagingSenderId: "631403892452",
      appId: "1:631403892452:web:66d382bf5f143fc05de6f1"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const authBtn = document.getElementById("authBtn");
    const loader = document.getElementById("loader");
    const themeBtn = document.getElementById("themeBtn");

    // üåó ‡πÇ‡∏´‡∏°‡∏î‡∏ò‡∏µ‡∏°
    themeBtn.onclick = () => {
      document.body.classList.toggle("light");
      themeBtn.textContent = document.body.classList.contains("light") ? "‚òÄÔ∏è" : "üåô";
      localStorage.setItem("theme", document.body.classList.contains("light") ? "light" : "dark");
    };
    if (localStorage.getItem("theme") === "light") {
      document.body.classList.add("light");
      themeBtn.textContent = "‚òÄÔ∏è";
    }

    // üîê ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
    const provider = new GoogleAuthProvider();
    authBtn.onclick = async () => {
      if (auth.currentUser) {
        await signOut(auth);
      } else {
        await signInWithPopup(auth, provider);
      }
    };

    // üß≠ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        authBtn.textContent = "‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö";
        const snap = await getDoc(doc(db, "users", user.uid));
        const isAdmin = snap.exists() && snap.data().role === "admin";
        document.querySelectorAll(".admin-only").forEach(el => el.style.display = isAdmin ? "block" : "none");
      } else {
        authBtn.textContent = "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
        document.querySelectorAll(".admin-only").forEach(el => el.style.display = "none");
      }
    });

    // üö™ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤ + ‡πÇ‡∏´‡∏•‡∏î
    window.goPage = (url) => {
      loader.style.display = "flex";
      setTimeout(() => { location.href = url; }, 800);
    };

    // ‚ò∞ ‡∏õ‡∏∏‡πà‡∏°‡∏ã‡πâ‡∏≠‡∏ô
    const fab = document.getElementById("fab");
    const menu = document.getElementById("fabMenu");
    fab.onclick = () => {
      menu.style.display = menu.style.display === "flex" ? "none" : "flex";
    };
    window.onclick = (e) => {
      if (!fab.contains(e.target) && !menu.contains(e.target)) menu.style.display = "none";
    };
  </script>
</body>
</html>
