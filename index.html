<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TodoTask Pro Enterprise</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary: #6f42c1;
      --bg-light: #f4f4f8;
      --bg-dark: #0f111a;
      --card-light: rgba(255, 255, 255, 0.7);
      --card-dark: rgba(25, 25, 35, 0.6);
      --text-dark: #222;
      --text-light: #eee;
      --border-glass: rgba(255,255,255,0.2);
    }

    body {
      font-family: 'Sarabun', sans-serif;
      background: var(--bg-dark);
      color: var(--text-light);
      margin: 0;
      transition: background 0.5s, color 0.5s;
      backdrop-filter: blur(10px);
    }

    body.light {
      background: var(--bg-light);
      color: var(--text-dark);
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 18px 25px;
      backdrop-filter: blur(12px);
      background: rgba(255,255,255,0.05);
      border-bottom: 1px solid var(--border-glass);
      position: sticky; top: 0; z-index: 10;
    }

    header h1 { margin: 0; font-size: 1.3em; color: var(--primary); }
    .menu-btn { font-size: 1.6em; background: none; border: none; color: inherit; cursor: pointer; }

    .menu {
      position: absolute; top: 70px; right: 25px;
      display: none; flex-direction: column;
      background: rgba(30,30,45,0.9);
      border: 1px solid var(--border-glass);
      border-radius: 12px;
      overflow: hidden;
      backdrop-filter: blur(10px);
      z-index: 999;
    }

    .menu button {
      background: transparent; border: none; color: var(--text-light);
      padding: 12px 20px; text-align: left; cursor: pointer;
      transition: background 0.3s;
    }
    .menu button:hover { background: rgba(255,255,255,0.1); }
    body.light .menu { background: rgba(255,255,255,0.9); color: var(--text-dark); }
    body.light .menu button { color: var(--text-dark); }

    main { max-width: 900px; margin: 30px auto; padding: 0 20px; }

    .add-area {
      display: flex; gap: 10px; margin-bottom: 20px;
    }

    .add-area input {
      flex: 1; padding: 10px; border-radius: 10px;
      border: 1px solid var(--border-glass);
      background: rgba(255,255,255,0.1);
      color: inherit;
      outline: none;
    }

    .add-area button {
      background: var(--primary);
      border: none; color: white; border-radius: 10px;
      padding: 10px 15px; cursor: pointer;
    }

    .board {
      display: flex; flex-direction: column; gap: 15px;
    }

    .project {
      background: var(--card-dark);
      border: 1px solid var(--border-glass);
      border-radius: 15px;
      padding: 15px;
      backdrop-filter: blur(10px);
      cursor: grab;
      transition: transform 0.2s;
    }

    .project.dragging { opacity: 0.5; transform: scale(1.02); }
    body.light .project { background: var(--card-light); }

    .project h2 {
      margin: 0 0 10px; color: var(--primary);
      font-size: 1.1em;
    }

    .task-list { list-style: none; padding-left: 20px; }
    .task-list li { margin: 5px 0; }

    .task-list input[type="checkbox"] {
      accent-color: var(--primary);
      transform: scale(1.2);
      margin-right: 6px;
    }

    .add-task {
      display: flex; gap: 8px; margin-top: 10px;
    }

    .add-task input {
      flex: 1; padding: 8px; border-radius: 8px;
      border: 1px solid var(--border-glass);
      background: rgba(255,255,255,0.1);
      color: inherit;
      outline: none;
    }

    .add-task button {
      border: none; border-radius: 8px;
      background: var(--primary); color: #fff;
      padding: 8px 10px; cursor: pointer;
    }

    @media (max-width: 700px) {
      .add-area, .add-task { flex-direction: column; }
    }
  </style>
</head>

<body>
  <header>
    <h1>TodoTask Pro Enterprise</h1>
    <button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
    <div class="menu" id="menu">
      <button onclick="goPage('report.html')">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
      <button onclick="goPage('settings.html')">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
      <button onclick="goPage('team.html')">üë• ‡∏ó‡∏µ‡∏°</button>
      <button onclick="goPage('test.html')">üß™ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
      <button onclick="goPage('login.html')">üîë ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</button>
      <button onclick="goPage('logout.html')">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      <button onclick="toggleTheme()">üåó ‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô/‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô</button>
    </div>
  </header>

  <main>
    <div class="add-area">
      <input id="projectInput" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡∏ç‡πà (Project)..." />
      <button onclick="addProject()">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
    </div>

    <div class="board" id="board"></div>
  </main>

  <script>
    const board = document.getElementById("board");
    let projects = JSON.parse(localStorage.getItem("projects") || "[]");

    // ‡πÄ‡∏°‡∏ô‡∏π
    function toggleMenu() {
      const m = document.getElementById("menu");
      m.style.display = m.style.display === "flex" ? "none" : "flex";
    }
    window.onclick = e => {
      const menu = document.getElementById("menu");
      if (!e.target.closest('.menu-btn') && !e.target.closest('.menu')) menu.style.display = "none";
    };

    function goPage(p){ location.href = p; }

    // ‡∏ò‡∏µ‡∏°
    function toggleTheme() {
      document.body.classList.toggle("light");
      localStorage.setItem("theme", document.body.classList.contains("light") ? "light":"dark");
    }
    if (localStorage.getItem("theme")==="light") document.body.classList.add("light");

    function save(){ localStorage.setItem("projects", JSON.stringify(projects)); }

    // ‡πÄ‡∏û‡∏¥‡πà‡∏° Project
    function addProject(){
      const name = document.getElementById("projectInput").value.trim();
      if(!name) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô");
      projects.push({name, done:false, tasks:[]});
      document.getElementById("projectInput").value="";
      render(); save();
    }

    // ‡πÄ‡∏û‡∏¥‡πà‡∏° Task
    function addTask(pIndex){
      const input = document.getElementById(`taskInput-${pIndex}`);
      const text = input.value.trim();
      if(!text) return;
      projects[pIndex].tasks.push({text, done:false});
      input.value="";
      render(); save();
    }

    // Toggle Task
    function toggleTask(pIndex, tIndex){
      const task = projects[pIndex].tasks[tIndex];
      task.done = !task.done;
      projects[pIndex].done = projects[pIndex].tasks.length && projects[pIndex].tasks.every(t=>t.done);
      render(); save();
    }

    // ‡∏•‡∏ö Project
    function removeProject(i){
      projects.splice(i,1);
      render(); save();
    }

    // Drag & Drop
    function dragStart(e){ e.target.classList.add('dragging'); }
    function dragEnd(e){ e.target.classList.remove('dragging'); save(); }
    function dragOver(e){
      e.preventDefault();
      const dragging = document.querySelector('.dragging');
      const after = [...board.querySelectorAll('.project:not(.dragging)')].find(el => e.clientY <= el.offsetTop + el.offsetHeight/2);
      if(after) board.insertBefore(dragging, after);
      else board.appendChild(dragging);
      reorderProjects();
    }
    function reorderProjects(){
      const order = [...board.children].map(div=>div.dataset.index);
      projects = order.map(i=>projects[i]);
    }

    // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
    function render(){
      board.innerHTML="";
      projects.forEach((p,i)=>{
        const div=document.createElement("div");
        div.className="project";
        div.draggable=true;
        div.dataset.index=i;
        div.ondragstart=dragStart;
        div.ondragend=dragEnd;
        div.innerHTML=`
          <h2>${p.done?"‚úÖ ":""}${p.name}</h2>
          <ul class="task-list">
            ${p.tasks.map((t,ti)=>`
              <li><label><input type="checkbox" ${t.done?"checked":""} onchange="toggleTask(${i},${ti})"> ${t.text}</label></li>
            `).join("")}
          </ul>
          <div class="add-task">
            <input id="taskInput-${i}" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏¢‡πà‡∏≠‡∏¢..." />
            <button onclick="addTask(${i})">+</button>
            <button onclick="removeProject(${i})">‡∏•‡∏ö</button>
          </div>`;
        board.appendChild(div);
      });
      board.ondragover = dragOver;
    }

    render();
  </script>
</body>
</html>
