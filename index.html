<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TodoTask Pro Enterprise</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root {
  --primary:#6a4cff;
  --secondary:#8e7dff;
  --bg-dark:#0a0717;
  --bg-light:#f9f8ff;
  --card-dark:#1a1630;
  --card-light:#ffffff;
  --text-dark:#222;
  --text-light:#f2f2f2;
}
body {
  font-family:'Sarabun',sans-serif;
  margin:0;
  background:linear-gradient(135deg,#1a1133,#0a0717);
  color:var(--text-light);
  transition:.4s;
}
body.light{background:linear-gradient(135deg,#f3f1ff,#fff);color:var(--text-dark);}
.navbar{
  display:flex;justify-content:space-between;align-items:center;
  padding:15px 30px;background:rgba(255,255,255,0.05);
  backdrop-filter:blur(10px);box-shadow:0 2px 10px rgba(0,0,0,.2);
}
body.light .navbar{background:rgba(255,255,255,.6);box-shadow:0 2px 10px rgba(0,0,0,.05);}
h2{margin:0;}
.task-board{max-width:1000px;margin:30px auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;}
.task-card{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.2);border-radius:12px;padding:20px;text-align:center;backdrop-filter:blur(10px);transition:.3s;}
.task-card:hover{transform:scale(1.03);}
body.light .task-card{background:rgba(255,255,255,.7);border-color:rgba(0,0,0,.1);}

/* --- Floating Button --- */
.fab-wrapper{position:fixed;bottom:30px;right:30px;z-index:999;}
.fab-main{
  background:linear-gradient(135deg,#5d3eff,#9b7fff,#7a5cff);
  color:white;border:none;border-radius:50%;
  width:70px;height:70px;font-size:30px;font-weight:600;cursor:pointer;
  backdrop-filter:blur(12px);
  box-shadow:0 0 15px rgba(145,100,255,.5),0 0 30px rgba(120,80,255,.4);
  animation:subtleGlow 3s infinite alternate;
  transition:all .4s;
}
@keyframes subtleGlow{from{box-shadow:0 0 10px rgba(140,100,255,.4);}to{box-shadow:0 0 25px rgba(160,120,255,.7);}}
.fab-main:hover{transform:rotate(135deg) scale(1.08);background:linear-gradient(135deg,#8e7dff,#b59fff,#c3a9ff);}
.fab-main:active{animation:pulseClick .4s ease;}
@keyframes pulseClick{0%{transform:scale(1);}50%{transform:scale(1.1);}100%{transform:scale(1);}}

.fab-menu{position:absolute;bottom:80px;right:0;display:flex;flex-direction:column;align-items:flex-end;gap:10px;opacity:0;pointer-events:none;transform:translateY(20px);transition:all .4s;}
.fab-menu.show{opacity:1;pointer-events:auto;transform:translateY(0);}
.fab-menu button{
  background:rgba(255,255,255,.15);color:white;
  border:none;border-radius:12px;padding:10px 18px;font-weight:600;
  backdrop-filter:blur(10px);cursor:pointer;transition:.3s;
}
.fab-menu button:hover{background:rgba(255,255,255,.3);transform:translateX(-3px);box-shadow:0 0 15px rgba(160,120,255,.6);}
body.light .fab-main{background:linear-gradient(135deg,#bba9ff,#e7e1ff,#d5cbff);color:#2b1f5f;}
body.light .fab-menu button{color:#2b1f5f;background:rgba(255,255,255,.7);}

/* --- Modal Login --- */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(6px);justify-content:center;align-items:center;z-index:300;}
.modal{
  background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.3);
  backdrop-filter:blur(15px);border-radius:15px;padding:30px;width:90%;max-width:400px;color:white;text-align:center;
}
body.light .modal{background:rgba(255,255,255,.9);color:#333;}
.modal input{width:100%;padding:12px;margin-bottom:12px;border-radius:8px;border:1px solid #ccc;text-align:center;}
.modal button{width:100%;padding:12px;border:none;border-radius:8px;background:var(--secondary);color:#fff;font-weight:600;cursor:pointer;}
.switch-link{color:var(--secondary);cursor:pointer;font-size:14px;margin-top:10px;display:block;}
</style>
</head>

<body>
<div class="navbar">
  <h2>TodoTask Pro Enterprise</h2>
  <button onclick="toggleTheme()" style="background:none;border:none;font-size:1.2em;color:inherit;cursor:pointer;">üåô</button>
</div>

<div class="task-board">
  <div class="task-card">üìù ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡∏≤‡∏ô</div>
  <div class="task-card">üìÖ ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</div>
</div>

<!-- ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏≠‡∏¢ -->
<div class="fab-wrapper">
  <button class="fab-main" onclick="toggleFabMenu()">Ôºã</button>
  <div class="fab-menu" id="fabMenu">
    <button onclick="goReport()">üìä ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
    <button onclick="goSettings()">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</button>
    <button id="adminTestBtn" style="display:none;" onclick="goTest()">üß™ ‡πÄ‡∏ó‡∏™‡∏£‡∏∞‡∏ö‡∏ö</button>
    <button id="loginBtn" onclick="openModal()">üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
    <button id="logoutBtn" onclick="logout()" style="display:none;">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
  </div>
</div>

<!-- Modal Login -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal">
    <h3>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h3>
    <input type="email" id="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•" />
    <input type="password" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" />
    <button onclick="emailLogin()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
    <span class="switch-link" onclick="closeModal()">‡∏õ‡∏¥‡∏î</span>
  </div>
</div>

<script type="module">
import {initializeApp} from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
import {getAuth,signInWithEmailAndPassword,signOut,onAuthStateChanged} from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
import {getFirestore,doc,getDoc} from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";

const firebaseConfig={apiKey:"AIzaSyB_7tyj_BAyFzKEYVrZXfQjWCUXGS7VqKY",authDomain:"my-todo-list-9d2fa.firebaseapp.com",projectId:"my-todo-list-9d2fa",storageBucket:"my-todo-list-9d2fa.appspot.com",messagingSenderId:"631403892452",appId:"1:631403892452:web:66d382bf5f143fc05de6f1"};
const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

/* --- Theme --- */
window.toggleTheme=()=>{
  document.body.classList.toggle("light");
  localStorage.setItem("theme",document.body.classList.contains("light")?"light":"dark");
};
if(localStorage.getItem("theme")==="light")document.body.classList.add("light");

/* --- Modal --- */
window.openModal=()=>document.getElementById("modalOverlay").style.display="flex";
window.closeModal=()=>document.getElementById("modalOverlay").style.display="none";

/* --- Login --- */
window.emailLogin=async()=>{
  const email=document.getElementById("email").value.trim();
  const pass=document.getElementById("password").value.trim();
  try{
    await signInWithEmailAndPassword(auth,email,pass);
    closeModal();
  }catch(e){alert("‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "+e.message);}
};
window.logout=async()=>await signOut(auth);

/* --- FAB --- */
window.toggleFabMenu=()=>document.getElementById("fabMenu").classList.toggle("show");
document.addEventListener("click",e=>{
  const fab=document.querySelector(".fab-wrapper");
  if(!fab.contains(e.target))document.getElementById("fabMenu").classList.remove("show");
});

/* --- Links --- */
window.goReport=()=>location.href="report.html";
window.goSettings=()=>location.href="settings.html";
window.goTest=()=>location.href="test.html";

/* --- Auth State --- */
onAuthStateChanged(auth,async user=>{
  const loginBtn=document.getElementById("loginBtn");
  const logoutBtn=document.getElementById("logoutBtn");
  const testBtn=document.getElementById("adminTestBtn");
  if(user){
    loginBtn.style.display="none";
    logoutBtn.style.display="block";
    const snap=await getDoc(doc(db,"users",user.uid));
    if(snap.exists()&&snap.data().role==="admin"){testBtn.style.display="block";}
  }else{
    loginBtn.style.display="block";
    logoutBtn.style.display="none";
    testBtn.style.display="none";
  }
});
</script>
</body>
</html>
